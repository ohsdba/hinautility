# 朝阳数据 - SQL查询工具

## 项目概述

朝阳数据是一个功能强大的Web-based SQL查询工具，支持多数据库连接、查询执行、结果导出和安全管理。该工具专为数据分析师、开发人员和数据库管理员设计，提供直观的界面和丰富的功能。

## 核心功能

### 🔍 数据库支持
- **多数据库支持**: PostgreSQL, MySQL，Oracle，TiDB，OceanBase，崖山，人大金仓, 瀚高, 华为高斯, 优图, 海量, ,南大通用, 万里, 达梦, 神通, 巨杉
- **连接池管理**: 智能连接池，支持连接超时和重试机制
- **数据库配置管理**: 支持多数据库配置，灵活切换

### 🛡️ 安全特性
- **应用级密码保护**: 可选的应用访问密码
- **SQL注入防护**: 多层SQL安全检查
- **请求频率限制**: 防止恶意请求
- **账户锁定机制**: 防止暴力破解
- **输入验证**: 严格的输入参数验证

### 📊 查询与导出
- **SQL执行**: 支持单条和批量SQL语句执行
- **查询计划分析**: EXPLAIN计划分析功能
- **结果导出**: 支持Excel、CSV、HTML格式导出
- **分页显示**: 智能分页，支持大数据集
- **结果缓存**: 查询结果临时缓存机制

### 🎨 用户体验
- **主题切换**: 多种主题色彩方案
- **响应式设计**: 适配各种设备屏幕
- **离线支持**: 完全离线的Web应用
- **常用SQL管理**: 保存和管理常用SQL语句

## 技术架构

### 后端技术栈
- **框架**: Flask 2.0+
- **数据库驱动**: psycopg2, PyMySQL, cx_Oracle,yasdb等
- **Excel处理**: openpyxl
- **数据处理**: pandas
- **配置管理**: JSON配置文件

### 前端技术栈
- **UI框架**: Bootstrap 5
- **代码高亮**: Prism.js
- **SQL美化**: SQL Formatter
- **图标**: 动态Favicon

### 系统架构
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Web Browser   │────│   Flask App     │────│   Database      │
│                 │    │                 │    │                 │
│ - Bootstrap UI  │    │ - Route处理     │    │ - PostgreSQL    │
│ - SQL编辑器     │    │ - 安全配置      │    │ - MySQL         │
│ - 结果展示      │    │ - 导出功能      │    │ - Oracle        │
│ - 主题切换      │    │ - 连接管理      │    │ - 其他国产数据库 │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

## 项目结构

```
朝阳数据/
├── app.py                    # 主应用文件
├── requirements.txt          # Python依赖
├── conf/                     # 配置文件目录
│   ├── app_config.json       # 应用配置
│   ├── db_config.json        # 数据库配置
│   └── common_sql.json       # 常用SQL配置
├── html/                     # 前端模板
│   └── index.html           # 主界面
├── static/                   # 静态资源
│   ├── css/                 # 样式文件
│   │   ├── bootstrap.min.css
│   │   └── prism.css
│   └── js/                  # JavaScript文件
│       ├── bootstrap.bundle.min.js
│       ├── prism.js
│       └── sql-formatter.min.js
└── log/                     # 日志文件（运行时生成）
    └── sql_query_logs.log   # SQL查询日志
```

## 快速开始

### 环境要求
- Python 3.7+
- 支持的数据库客户端驱动

### 安装步骤
1. 克隆项目到本地
2. 安装依赖：`pip install -r requirements.txt`
3. 配置数据库连接：编辑 `conf/db_config.json`
4. 启动应用：`python app.py`
5. 访问：http://localhost:5000

### 配置说明
详细配置说明请参考 [配置文档](docs/configuration.md)

## 功能详解

### 数据库连接管理
- 支持多数据库配置保存
- 连接测试功能
- 默认数据库设置
- 密码加密存储

### SQL执行与安全
- 智能SQL语句分割
- 危险操作检测和阻止
- 查询超时控制
- 结果集大小限制

### 数据导出功能
- **Excel导出**: 支持自定义表头颜色、包含/排除表头
- **CSV导出**: 支持多种分隔符（逗号、分号、制表符、竖线、空格）
- **HTML导出**: Oracle AWR报告风格的专业报表

### 系统管理
- 应用配置管理
- 日志记录和审计
- 性能监控
- 自动锁定和超时管理

## 安全特性

### 多层安全防护
1. **应用级访问控制**: 可选密码保护
2. **SQL注入防护**: 模式匹配和关键词过滤
3. **请求频率限制**: 防止DDoS攻击
4. **账户锁定**: 防止暴力破解
5. **输入验证**: 参数类型和长度检查

### 安全配置
- 可配置的登录失败次数限制
- 账户锁定时间设置
- 密码强度要求（可选）
- 会话超时管理

## 扩展性

### 支持新数据库类型
通过简单的配置即可添加新的数据库类型支持：
1. 在 `SUPPORTED_DATABASES` 列表中添加新类型
2. 实现对应的连接函数
3. 配置驱动映射关系

### 自定义导出格式
可以轻松添加新的导出格式：
1. 实现数据转换函数
2. 添加新的导出路由
3. 更新前端界面

## 贡献指南

欢迎贡献代码！请阅读 [贡献指南](docs/contributing.md) 了解如何参与项目开发。

## 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件。

## 支持与联系

如有问题或建议，请通过以下方式联系：
- 提交 Issue
- 发送邮件
- 技术文档: [docs/](docs/)

---